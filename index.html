<!DOCTYPE html>
<html>
<head>
  <title>Wedding Aquarium</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    #controls {
      position: fixed;
      bottom: 10px;
      left: 10px;
      background: rgba(255,255,255,0.7);
      padding: 10px;
      border-radius: 10px;
      font-family: Arial;
    }
  </style>
</head>
<body>
  <script src="sketch.js"></script>
  <script>
    // Communication channel for instant updates
    const channel = new BroadcastChannel('aquarium');
    channel.onmessage = (e) => {
      if (e.data.type === 'newFish') {
        addFishFromData(e.data.data);
      }
    };
    
    // Check for existing uploads on load
    window.addEventListener('load', () => {
      const fishData = localStorage.getItem('newFish');
      if (fishData) addFishFromData(fishData);
    });
    
    function addFishFromData(dataUrl) {
      const img = new Image();
      img.onload = () => {
        const p5Img = createImage(img.width, img.height);
        p5Img.copy(img, 0, 0, img.width, img.height, 0, 0, img.width, img.height);
        p5Img.resize(200, 0); // Standardize size
        
        if (typeof addFishToAquarium === 'function') {
          addFishToAquarium(p5Img);
          document.getElementById('fish-count').textContent = 
            `${fishes.length} fish`;
        }
      };
      img.src = dataUrl;
    }
  </script>
</body>
</html>